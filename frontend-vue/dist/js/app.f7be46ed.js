(function(){"use strict";var e={311:function(e,t,n){var o=n(963),r=n(252);function i(e,t,n,o,i,a){const l=(0,r.up)("router-view");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)(l)])}var a={},l=n(744);const s=(0,l.Z)(a,[["render",i]]);var c=s,u=n(201);const d={class:"container"},m={class:"delayed"},p=(0,r._)("h1",null,"Försenade tåg",-1),f={class:"main-delayed-trains",ref:"mainDelayedTrains"},w={class:"map",ref:"map"};function h(e,t,n,o,i,a){const l=(0,r.up)("render-delayed-table");return(0,r.wg)(),(0,r.iD)("div",d,[(0,r._)("div",m,[p,(0,r._)("div",f,null,512),(0,r.Wm)(l,{data:i.delayedData},null,8,["data"])]),(0,r._)("div",w,null,512)])}var v=n(920),y=n(243),k=n.n(y),b=n(577);const g={class:"delayed-trains",ref:"delayedTrains",id:"delayed-trains"},T=["onClick"],_={class:"train-number"},D={class:"current-station"},L={key:0,class:"modal",id:"train-modal"},O={key:0},V={key:1},z=(0,r._)("strong",null,"Försenad:",-1),M=(0,r._)("label",{for:"reason-code"},"Orsakskod",-1),C=(0,r._)("br",null,null,-1),I=["value"],S=(0,r._)("br",null,null,-1),j=(0,r._)("br",null,null,-1),x=(0,r._)("input",{type:"submit",value:"Skapa nytt ärende"},null,-1);function F(e,t,n,i,a,l){return(0,r.wg)(),(0,r.iD)("div",g,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.data,((e,t)=>((0,r.wg)(),(0,r.iD)("div",{key:t,onClick:t=>l.openTicketView(e)},[(0,r._)("div",_,(0,b.zw)(e.OperationalTrainNumber),1),(0,r._)("div",D,[(0,r._)("div",null,(0,b.zw)(e.LocationSignature),1),(0,r._)("div",null,(0,b.zw)(e.FromLocation?e.FromLocation[0].LocationName+" -> ":"")+" "+(0,b.zw)(e.ToLocation?e.ToLocation[0].LocationName:""),1)])],8,T)))),128)),a.showTicketView?((0,r.wg)(),(0,r.iD)("div",L,[(0,r._)("button",{onClick:t[0]||(t[0]=(...e)=>l.closeTicketView&&l.closeTicketView(...e)),id:"back"},"Close Ticket"),(0,r._)("h1",null,"Nytt ärende #"+(0,b.zw)(e.newTicketId),1),a.selectedItem&&a.selectedItem.FromLocation?((0,r.wg)(),(0,r.iD)("h3",O," Tåg från "+(0,b.zw)(a.selectedItem.FromLocation[0].LocationName)+" till "+(0,b.zw)(a.selectedItem.ToLocation[0].LocationName)+". Just nu i "+(0,b.zw)(a.selectedItem.LocationSignature)+". ",1)):(0,r.kq)("",!0),a.selectedItem?((0,r.wg)(),(0,r.iD)("p",V,[z,(0,r.Uk)(" "+(0,b.zw)(l.outputDelay(a.selectedItem)),1)])):(0,r.kq)("",!0),(0,r._)("form",{onSubmit:t[2]||(t[2]=(0,o.iM)(((...e)=>l.createTicket&&l.createTicket(...e)),["prevent"]))},[M,C,(0,r.wy)((0,r._)("select",{id:"reason-code","onUpdate:modelValue":t[1]||(t[1]=e=>a.selectedReason=e)},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.reasonCodes,(e=>((0,r.wg)(),(0,r.iD)("option",{key:e.Code,value:e.Code},(0,b.zw)(e.Level3Description),9,I)))),128))],512),[[o.bM,a.selectedReason]]),S,j,x],32)])):(0,r.kq)("",!0)],512)}var P={data(){return{showTicketView:!1,selectedItem:null,selectedReason:null,reasonCodes:[]}},props:{data:Array},methods:{openTicketView(e){this.selectedItem=e,this.showTicketView=!0},closeTicketView(){this.showTicketView=!1},outputDelay(e){const t=new Date(e.AdvertisedTimeAtLocation),n=new Date(e.EstimatedTimeAtLocation),o=Math.abs(n-t);return Math.floor(o/6e4)+" minuter"},createTicket(){}}};const N=(0,l.Z)(P,[["render",F]]);var Z=N,A={data(){return{markers:{},delayedData:[]}},mounted(){this.renderMainView()},methods:{renderMainView(){const e=this.$refs.mainDelayedTrains;e.innerHTML="";const t=k().map(this.$refs.map).setView([62.173276,14.942265],5);k().tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(t);const n=(0,v.ZP)("http://localhost:1337");n.on("message",(e=>{if(e.trainnumber in this.markers){let t=this.markers[e.trainnumber];t.setLatLng(e.position)}else{let n=k().marker(e.position).bindPopup(e.trainnumber).addTo(t);this.markers[e.trainnumber]=n}})),fetch("http://localhost:1337/delayed").then((e=>e.json())).then((e=>{this.delayedData=e.data}))}},components:{"render-delayed-table":Z}};const q=(0,l.Z)(A,[["render",h]]);var H=q;const R=[{path:"/",name:"main",component:H}],E=(0,u.p7)({history:(0,u.PO)(),routes:R}),K=(0,o.ri)(c);K.use(E),K.mount("#app")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,i){if(!o){var a=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],i=e[u][2];for(var l=!0,s=0;s<o.length;s++)(!1&i||a>=i)&&Object.keys(n.O).every((function(e){return n.O[e](o[s])}))?o.splice(s--,1):(l=!1,i<a&&(a=i));if(l){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[o,r,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,i,a=o[0],l=o[1],s=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);if(s)var u=s(n)}for(t&&t(o);c<a.length;c++)i=a[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},o=self["webpackChunktrain_controller_2_0"]=self["webpackChunktrain_controller_2_0"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(311)}));o=n.O(o)})();
//# sourceMappingURL=app.f7be46ed.js.map